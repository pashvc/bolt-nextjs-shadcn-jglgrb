# Функциональные требования к приложению QR-check (FRD) v2

---

## 1. Введение

### 1.1 Цель документа

Настоящий документ описывает функциональные требования к приложению **QR-check**
с учетом последних бизнес-требований и изменений, включая использование **Deno
KV** в качестве базы данных и подтверждение использования **Deno Fresh**.
Документ служит руководством для команды разработки при реализации
функциональности приложения, обеспечивая соответствие бизнес-требованиям и
ожиданиям пользователей.

### 1.2 Область применения

Документ охватывает все функциональные аспекты приложения, включая
функциональность для Зрителей, Промоутеров и Администраторов, а также интеграции
с внешними сервисами, интерфейсы и ограничения системы.

### 1.3 Определения, сокращения и аббревиатуры

- **PWA**: Прогрессивное веб-приложение.
- **2FA**: Двухфакторная аутентификация.
- **UI/UX**: Пользовательский интерфейс и опыт взаимодействия.
- **GDPR**: Общий регламент по защите данных.
- **PCI DSS**: Стандарт безопасности данных индустрии платежных карт.
- **Deno KV**: Встроенная база данных ключ-значение в Deno.
- **Deno Fresh**: Фреймворк для создания современных веб-приложений на Deno.

### 1.4 Ссылки

- [PRD: Документ требований к продукту для приложения QR-check (Обновленная
  версия)]
- [BRD: Бизнес-требования к приложению QR-check (Обновленная версия)]

---

## 2. Общее описание

### 2.1 Перспектива продукта

**QR-check** — это современное прогрессивное веб-приложение, разработанное с
использованием **Deno Fresh**, **Twind** и **Deno KV**. Приложение предназначено
для управления мероприятиями и участия в них, предоставляя пользователям
уникальные функции, такие как расширенный поиск по артисту, взаимодействие с
аудиторией и управление дополнительными товарами и услугами на мероприятиях.

### 2.2 Функциональность продукта

Приложение предоставляет следующие основные функции:

- Регистрация и аутентификация пользователей.
- Расширенный поиск и просмотр мероприятий.
- Покупка билетов и дополнительных товаров и услуг.
- Вход на мероприятия с помощью QR-кодов.
- Инструменты для взаимодействия с аудиторией для Промоутеров.
- Возможность обмена базами гостей между организаторами.
- Расширенные функции управления для Администраторов.

### 2.3 Характеристики пользователей

- **Зрители**: Пользователи, которые посещают мероприятия, покупают билеты и
  дополнительные услуги.
- **Промоутеры**: Пользователи, которые создают и управляют мероприятиями,
  взаимодействуют с аудиторией.
- **Администраторы**: Пользователи с полным доступом для управления системой и
  обеспечения безопасности.

### 2.4 Ограничения

- Приложение ориентировано на современные браузеры, поддерживающие PWA.
- Зависимость от стабильности работы внешних сервисов (платежные системы,
  социальные сети).
- Необходимость соответствия требованиям GDPR и PCI DSS.
- Использование **Deno KV** предполагает определенные ограничения в структуре
  данных и масштабируемости.

### 2.5 Предположения и зависимости

- Пользователи имеют доступ к стабильному интернет-соединению.
- Внешние сервисы (API социальных сетей, платежные шлюзы) доступны и
  функционируют корректно.
- Пользователи имеют устройства, поддерживающие современные веб-стандарты.

---

## 3. Специфические требования

### 3.1 Функциональные требования

#### 3.1.1 Регистрация и аутентификация пользователей

**Описание:**

- Пользователь может зарегистрироваться с использованием электронной почты,
  номера телефона или через социальные сети (Google, Facebook).
- Поддержка двухфакторной аутентификации (2FA) для повышения безопасности.

**Требования:**

- Система должна позволять пользователю регистрироваться с использованием
  электронной почты и создавать пароль.
- Система должна отправлять подтверждение регистрации на указанную электронную
  почту.
- Система должна поддерживать вход через OAuth для Google и Facebook.
- Система должна предоставлять возможность включения 2FA через
  приложение-аутентификатор.
- Данные пользователей должны храниться в **Deno KV** с соблюдением мер
  безопасности.

#### 3.1.2 Расширенный поиск и просмотр мероприятий

**Описание:**

- Пользователи могут искать и просматривать мероприятия по различным критериям,
  включая артиста.

**Требования:**

- Система должна предоставлять поиск мероприятий по названию, дате, категории и
  артисту.
- Система должна поддерживать фильтрацию по различным критериям (местоположение,
  цена, рейтинг).
- Система должна отображать детальную информацию о мероприятии, включая
  название, описание, дату и время, место проведения, цены на билеты, список
  артистов и мультимедийный контент.
- Система должна предоставлять персонализированные рекомендации на основе
  интересов и истории посещений пользователя.

#### 3.1.3 Покупка билетов и дополнительных услуг

**Описание:**

- Пользователи могут покупать билеты и дополнительные товары и услуги через
  приложение.

**Требования:**

- Система должна поддерживать оплату с использованием банковских карт, Apple Pay
  и Google Pay через интегрированные платежные шлюзы.
- После успешной оплаты система должна генерировать электронный билет с
  уникальным QR-кодом.
- Система должна позволять пользователям предзаказывать и оплачивать товары и
  услуги до, во время и после мероприятия.
- Система должна отправлять подтверждение покупки на электронную почту
  пользователя и сохранять информацию в аккаунте пользователя.
- Транзакции и связанные данные должны храниться в **Deno KV** с учетом
  безопасности и целостности данных.

#### 3.1.4 Вход на мероприятия с помощью QR-кодов

**Описание:**

- На входе на мероприятие билеты и предзаказанные услуги проверяются с помощью
  сканирования QR-кодов.

**Требования:**

- Система должна предоставлять приложение или интерфейс для сканирования
  QR-кодов для организаторов.
- Система должна мгновенно проверять действительность билета и наличие
  предзаказанных услуг при сканировании.
- Система должна поддерживать офлайн-режим для сканирования QR-кодов с
  последующей синхронизацией данных.
- Данные о проверке билетов должны обновляться в **Deno KV** в реальном времени
  или при следующем соединении.

#### 3.1.5 Расширенные инструменты для Промоутеров

**Описание:**

- Промоутеры могут использовать расширенные инструменты для взаимодействия с
  аудиторией и управления своими мероприятиями.

**Требования:**

- Система должна позволять промоутеру приглашать гостей предыдущих мероприятий
  на новые события.
- Система должна предоставлять инструменты для управления базой гостей, включая
  сегментацию аудитории по различным критериям.
- Система должна позволять промоутерам продавать свои базы гостей другим
  организаторам при соблюдении правовых норм и получения согласия пользователей.
- Система должна предоставлять возможность продавать дополнительные товары и
  услуги через приложение.
- Система должна предоставлять аналитику продаж билетов, товаров и услуг.

#### 3.1.6 Взаимодействие между организаторами

**Описание:**

- Организаторы могут сотрудничать и взаимодействовать друг с другом через
  приложение.

**Требования:**

- Система должна позволять организаторам предлагать совместные мероприятия или
  акции.
- Система должна предоставлять механизмы для легального и согласованного обмена
  информацией об аудитории между организаторами, при условии получения согласия
  пользователей.
- Система должна обеспечивать безопасность и конфиденциальность данных при
  обмене информацией между организаторами.

#### 3.1.7 Расширенные функции для Администраторов

**Описание:**

- Администраторы имеют доступ к расширенным функциям управления системой и
  обеспечения безопасности.

**Требования:**

- Система должна предоставлять администратору возможность управлять
  пользователями (создание, редактирование, блокировка).
- Система должна позволять администратору управлять контентом (мероприятиями,
  отзывами, предложениями товаров и услуг).
- Система должна предоставлять доступ к настройкам системы и инструментам
  мониторинга.
- Система должна предоставлять инструменты для модерации взаимодействия между
  организаторами.
- Система должна вести журналы действий пользователей для аудита и обеспечения
  безопасности.

#### 3.1.8 Мультиязычность и темы оформления

**Описание:**

- Приложение поддерживает русский и английский языки, а также светлую и тёмную
  темы.

**Требования:**

- Система должна автоматически определять язык интерфейса по настройкам
  устройства пользователя.
- Система должна позволять пользователю вручную переключать язык в настройках.
- Система должна поддерживать светлую и тёмную темы, адаптируясь к системным
  настройкам пользователя.
- Все текстовые элементы должны быть локализованы и храниться с возможностью
  расширения языковой поддержки.

#### 3.1.9 Уведомления и коммуникации

**Описание:**

- Приложение предоставляет пользователям уведомления о важных событиях и
  коммуникации от организаторов.

**Требования:**

- Система должна отправлять push-уведомления о новых мероприятиях, специальных
  предложениях и сообщениях от организаторов.
- Система должна позволять пользователю настраивать предпочтения уведомлений.
- Система должна обеспечивать возможность отправки сообщений пользователям от
  имени организаторов, при условии получения согласия пользователей.

#### 3.1.10 Отзывы и рейтинги

**Описание:**

- Пользователи могут оставлять отзывы и оценки о мероприятиях и дополнительных
  услугах.

**Требования:**

- Система должна позволять пользователям оставлять текстовые отзывы и ставить
  рейтинг мероприятию и предоставленным услугам после их посещения или
  использования.
- Система должна отображать средний рейтинг и отзывы на странице мероприятия.
- Система должна предоставлять модерацию отзывов для Администраторов.
- Отзывы и рейтинги должны храниться в **Deno KV** с возможностью быстрого
  доступа и фильтрации.

#### 3.1.11 Социальное взаимодействие

**Описание:**

- Пользователи могут делиться мероприятиями и специальными предложениями в
  социальных сетях и интегрировать их с календарем.

**Требования:**

- Система должна предоставлять возможность поделиться ссылкой на мероприятие в
  популярных социальных сетях.
- Система должна позволять добавлять мероприятия в календарь устройства
  пользователя.
- Система должна поддерживать генерацию привлекательных превью при публикации
  ссылок в социальных сетях (Open Graph Protocol).

### 3.2 Интерфейсные требования

#### 3.2.1 Пользовательский интерфейс

**Требования:**

- Интерфейс должен быть адаптивным, корректно отображаться на мобильных
  устройствах, планшетах и настольных компьютерах.
- Использование интуитивно понятной навигации и стандартных элементов
  интерфейса.
- Поддержка жестов и взаимодействий, характерных для мобильных устройств.
- Интерфейс должен быть стилизован с использованием **Twind**, обеспечивая
  единый визуальный стиль.

#### 3.2.2 Внешние интерфейсы

**Требования:**

- Интеграция с API социальных сетей (Google, Facebook) для аутентификации и
  обмена контентом.
- Интеграция с платежными шлюзами (Тинькофф SDK, Stripe, PayPal) для обработки
  платежей.
- Интеграция с картографическими сервисами (Google Maps API или аналоги) для
  отображения мест проведения мероприятий.
- Интеграция с сервисами push-уведомлений (Firebase Cloud Messaging или
  аналоги).

### 3.3 Производительность

**Требования:**

- Приложение должно загружаться на мобильных устройствах за время не более 3
  секунд при нормальном соединении.
- Время отклика на действия пользователя не должно превышать 1 секунды.
- Система должна поддерживать одновременную работу не менее 50 000 активных
  пользователей без заметной деградации производительности.
- Использование **Deno KV** должно быть оптимизировано для
  высокопроизводительной работы с данными.

### 3.4 Безопасность

**Требования:**

- Все данные должны передаваться по защищенному протоколу HTTPS.
- Хранение паролей пользователей должно осуществляться с использованием
  безопасных хеширующих алгоритмов (например, bcrypt).
- Доступ к конфиденциальным данным должен быть ограничен в соответствии с ролями
  пользователей.
- Система должна быть защищена от распространенных уязвимостей (SQL Injection не
  применимо, но XSS, CSRF и др.).
- Соответствие требованиям GDPR и PCI DSS.
- Реализация механизма явного согласия пользователей на обработку и передачу их
  персональных данных.

---

## 4. Особенности системы

### 4.1 Регистрация и аутентификация

- **Приоритет:** Высокий.
- **Последовательность действий:**
  1. Пользователь выбирает способ регистрации (электронная почта, номер
     телефона, социальная сеть).
  2. Пользователь вводит необходимые данные.
  3. Система проверяет введенные данные на корректность.
  4. Система создает аккаунт и отправляет подтверждение.
  5. Пользователь подтверждает регистрацию (если требуется).
  6. Данные пользователя сохраняются в **Deno KV**.

### 4.2 Покупка билетов и дополнительных услуг

- **Приоритет:** Высокий.
- **Последовательность действий:**
  1. Пользователь выбирает мероприятие и желаемые билеты и услуги.
  2. Пользователь переходит к оплате.
  3. Система перенаправляет на платежный шлюз.
  4. Пользователь вводит платежные данные.
  5. Платежный шлюз подтверждает оплату.
  6. Система генерирует билет и подтверждение покупки услуг, отправляет их
     пользователю.
  7. Транзакция регистрируется в **Deno KV**.

### 4.3 Сканирование QR-кодов на мероприятии

- **Приоритет:** Средний.
- **Последовательность действий:**
  1. Сотрудник организатора открывает приложение сканирования.
  2. Сканирует QR-код билета посетителя.
  3. Система проверяет действительность билета и наличие предзаказанных услуг.
  4. Система отображает результат проверки (действительный/недействительный) и
     список услуг.
  5. Данные об использовании билета обновляются в **Deno KV**.

### 4.4 Взаимодействие с аудиторией для Промоутеров

- **Приоритет:** Высокий.
- **Последовательность действий:**
  1. Промоутер входит в свой аккаунт и переходит в раздел управления аудиторией.
  2. Просматривает базу гостей прошлых мероприятий.
  3. Создает приглашения для выбранных сегментов аудитории.
  4. Отправляет приглашения или специальные предложения.
  5. Система обеспечивает отправку сообщений с учетом согласия пользователей.

---

## 5. Внешние интерфейсы

### 5.1 Пользовательские интерфейсы

- **Мобильный интерфейс:** Оптимизирован для смартфонов, поддержка жестов,
  адаптивный дизайн.
- **Веб-интерфейс:** Доступен на настольных компьютерах и планшетах,
  использование стандартных элементов веб-интерфейса.
- **Интерфейс сканирования QR-кодов:** Простое и быстрое приложение или модуль
  для сканирования, доступный для устройств организаторов.

### 5.2 Программные интерфейсы

- **API социальных сетей:** Использование OAuth для аутентификации и возможности
  делиться контентом.
- **API платежных шлюзов:** Безопасная обработка платежей через интегрированные
  системы.
- **API картографических сервисов:** Отображение мест проведения мероприятий на
  карте.
- **Push-уведомления:** Интеграция с сервисами для отправки уведомлений
  пользователям.

---

## 6. Нефункциональные требования

### 6.1 Производительность

- Система должна обеспечивать масштабируемость для обработки растущего числа
  пользователей.
- Серверная часть должна быть оптимизирована для эффективного использования
  ресурсов.
- Использование **Deno KV** должно быть оптимизировано для быстрого доступа к
  данным.

### 6.2 Надежность

- Система должна иметь устойчивость к сбоям и обеспечивать резервное копирование
  данных.
- Время простоя системы должно быть минимальным.
- Реализация механизмов восстановления данных в случае ошибок.

### 6.3 Удобство использования

- Интерфейс должен быть интуитивно понятным даже для новых пользователей.
- Система должна предоставлять подсказки и помощь при необходимости.
- Поддержка персонализации интерфейса и настроек.

### 6.4 Поддержка

- Система должна быть легко обновляемой и расширяемой.
- Должна быть предусмотрена возможность быстрого исправления ошибок и внедрения
  новых функций.
- Обеспечение документации для пользователей и разработчиков.

### 6.5 Безопасность

- Соблюдение всех требований безопасности, описанных в разделе 3.4.
- Регулярное проведение аудитов безопасности.
- Обучение команды разработчиков по безопасности приложений.

---

## 7. Другие требования

### 7.1 База данных (Deno KV)

- **Структура данных:**
  - Использование ключей с префиксами для организации данных по типам (например,
    `user:{id}`, `event:{id}`).
  - Хранение сложных объектов в формате JSON.
  - Обеспечение атомарности операций для поддержания целостности данных.
- **Резервное копирование:**
  - Регулярное создание резервных копий данных.
  - Хранение резервных копий в безопасном месте с ограниченным доступом.

### 7.2 Правовые и нормативные требования

- Соблюдение требований GDPR по защите персональных данных пользователей.
- Соответствие стандартам PCI DSS при обработке платежных данных.
- Получение явного согласия пользователей на обработку и передачу персональных
  данных.
- Обеспечение возможности пользователя запросить удаление или изменение своих
  персональных данных.

---

## 8. Заключение

Данный документ подробно описывает функциональные требования к приложению
**QR-check** с учетом последних бизнес-требований и технических изменений,
включая использование **Deno KV** и **Deno Fresh**. Реализация этих требований
обеспечит соответствие приложения ожиданиям пользователей и бизнес-целям
проекта. Команда разработки должна использовать этот документ в качестве
руководства при создании и внедрении приложения, уделяя особое внимание
безопасности, производительности и удобству использования.

---

**Автор**: CTO Павел Сухачев

**Дата**: 14 ноября 2024 года

---
